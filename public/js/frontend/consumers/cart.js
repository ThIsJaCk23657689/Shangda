!function(t){var a={};function e(c){if(a[c])return a[c].exports;var r=a[c]={i:c,l:!1,exports:{}};return t[c].call(r.exports,r,r.exports,e),r.l=!0,r.exports}e.m=t,e.c=a,e.d=function(t,a,c){e.o(t,a)||Object.defineProperty(t,a,{enumerable:!0,get:c})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,a){if(1&a&&(t=e(t)),8&a)return t;if(4&a&&"object"==typeof t&&t&&t.__esModule)return t;var c=Object.create(null);if(e.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:t}),2&a&&"string"!=typeof t)for(var r in t)e.d(c,r,function(a){return t[a]}.bind(null,r));return c},e.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,"a",a),a},e.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)},e.p="/",e(e.s=86)}({0:function(t,a,e){"use strict";function c(t,a,e,c,r,o,n,s){var i,u="function"==typeof t?t.options:t;if(a&&(u.render=a,u.staticRenderFns=e,u._compiled=!0),c&&(u.functional=!0),o&&(u._scopeId="data-v-"+o),n?(i=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),r&&r.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(n)},u._ssrRegister=i):r&&(i=s?function(){r.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:r),i)if(u.functional){u._injectStyles=i;var l=u.render;u.render=function(t,a){return i.call(a),l(t,a)}}else{var d=u.beforeCreate;u.beforeCreate=d?[].concat(d,i):[i]}return{exports:t,options:u}}e.d(a,"a",(function(){return c}))},193:function(t,a,e){"use strict";e.r(a);var c={props:["carts","status"],data:function(){return{}},methods:{calculateTotal:function(t){this.status.totalcount=0,this.status.totalprice=0;for(var a=0;a<this.carts.length;a++)this.status.totalcount+=parseInt(this.carts[a].quantity),this.status.totalprice+=parseInt(this.carts[a].subtotal);this.status.totalprice=Math.round(this.status.totalprice)},removeItem:function(t){var a=this,e=$("#RemoveProductURL").text();axios.post(e,{_method:"DELETE",product_id:this.carts[t.index].product.id}).then((function(e){$.showSuccessModal(e.data.message),a.carts.splice(t.index,1);for(var c=0;c<a.carts.length;c++)a.carts[c].index=c;a.calculateTotal()})).catch((function(t){console.log("從購物車刪除商品時發生錯誤。"),$.showErrorModal(t)}))},checkout:function(t){var a=this;Swal.fire({title:"注意！",text:"您確定是否要結帳?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"確認",cancelButtonText:"取消"}).then((function(t){t.value&&a.submitCheckOutData()}))},submitCheckOutData:function(){$.showLoadingModal();var t=$("#CheckOutURL").text();axios.post(t,{carts:this.carts}).then((function(t){console.log(t.data),$.showSuccessModal(t.data.message)})).catch((function(t){console.log("結帳時發生錯誤。"),$.showErrorModal(t)}))}},created:function(){},mounted:function(){}},r=e(0),o=Object(r.a)(c,(function(){var t=this,a=t._self._c;return a("div",{staticClass:"cart-table"},[t._m(0),t._v(" "),t._l(t.carts,(function(e){return a("cart-row",{key:e.product.id,attrs:{cart:e},on:{"calculate-total":t.calculateTotal,"remove-item":t.removeItem}})})),t._v(" "),0==t.carts.length?a("div",{staticClass:"cart-row"},[t._m(1)]):t._e(),t._v(" "),a("div",{staticClass:"cart-footer"},[a("div",{staticClass:"cart-cell w-70 status-cell"},[t._v("\r\n            購買總金額（"+t._s(t.status.totalcount)+"個商品）："),a("span",{staticClass:"total-price"},[t._v("$"+t._s(t.status.totalprice))])]),t._v(" "),a("div",{staticClass:"cart-cell w-30"},[a("button",{staticClass:"btn btn-md btn-checkout",attrs:{type:"button",disabled:0==t.carts.length},on:{click:t.checkout}},[t._v("送出訂單")])])])],2)}),[function(){var t=this,a=t._self._c;return a("div",{staticClass:"cart-header"},[a("div",{staticClass:"cart-cell w-45"},[t._v("商品")]),t._v(" "),a("div",{staticClass:"cart-cell w-15"},[t._v("單價")]),t._v(" "),a("div",{staticClass:"cart-cell w-15"},[t._v("數量")]),t._v(" "),a("div",{staticClass:"cart-cell w-15"},[t._v("小計")]),t._v(" "),a("div",{staticClass:"cart-cell w-10"},[t._v("操作")])])},function(){var t=this._self._c;return t("div",{staticClass:"cart-cell w-100 h-80"},[t("h3",{staticClass:"mb-0"},[this._v("購物車尚未有任何商品，趕快到商品列表逛逛吧！")])])}],!1,null,null,null);a.default=o.exports},194:function(t,a,e){"use strict";e.r(a);var c={props:["cart"],data:function(){return{}},methods:{quantityOnInput:function(t){var a=t.target.value.trim();/^[1-9]\d*$|^$/.test(a)?(a<=0||a>999)&&(this.cart.quantity=1):this.cart.quantity=1,this.calculateSubTotal(this,t.target)},calculateSubTotal:_.debounce((function(t,a){var e=$("#UpdateProductQtyURL").text();$("input.quantity").attr("disabled",!0),axios.post(e,{_method:"PATCH",product_id:t.cart.product.id,quantity:t.cart.quantity}).then((function(a){$("input.quantity").attr("disabled",!1),""!=a.data.overflowMsg&&($.showWarningModal(a.data.overflowMsg),t.cart.quantity=a.data.realQty),t.cart.subtotal=Math.round(t.cart.product.retailPrice*t.cart.quantity),t.calculateTotal()})).catch((function(a){console.log("從購物車更新商品購買數量時發生錯誤。"),$.showErrorModal(a),t.cart.quantity=1,t.cart.subtotal=Math.round(t.cart.product.retailPrice*t.cart.quantity),t.calculateTotal()}))}),500),calculateTotal:function(){this.$emit("calculate-total")},removeItem:function(t){var a=this;Swal.fire({title:"注意！",text:"您確定要從購物車刪除此商品嗎?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"確認",cancelButtonText:"取消"}).then((function(t){t.value&&a.$emit("remove-item",{index:a.cart.index})}))}},created:function(){},mounted:function(){}},r=e(0),o=Object(r.a)(c,(function(){var t=this,a=t._self._c;return a("div",{staticClass:"cart-row"},[a("div",{staticClass:"cart-cell w-15 p-3 cart-pic"},[a("img",{attrs:{src:t.cart.product.coverImage,alt:"",width:"100%"}})]),t._v(" "),a("div",{staticClass:"cart-cell w-85 p-3 cart-spec"},[a("div",{staticClass:"cart-cell w-35"},[a("a",{staticClass:"product-link",attrs:{href:t.cart.product.showURL}},[t._v("\r\n                "+t._s(t.cart.product.name)+"\r\n            ")])]),t._v(" "),a("div",{staticClass:"cart-cell w-15"},[t._v("$"+t._s(t.cart.product.retailPrice))]),t._v(" "),a("div",{staticClass:"cart-cell w-20"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.cart.quantity,expression:"cart.quantity"}],staticClass:"form-control text-center quantity",attrs:{type:"text",name:"quantity[]"},domProps:{value:t.cart.quantity},on:{input:[function(a){a.target.composing||t.$set(t.cart,"quantity",a.target.value)},t.quantityOnInput]}})]),t._v(" "),a("div",{staticClass:"cart-cell w-15"},[t._v("$"+t._s(t.cart.subtotal))]),t._v(" "),a("div",{staticClass:"cart-cell w-15"},[a("button",{staticClass:"btn btn-md btn-danger",on:{click:t.removeItem}},[a("i",{staticClass:"far fa-trash-alt"})])])])])}),[],!1,null,null,null);a.default=o.exports},86:function(t,a,e){t.exports=e(87)},87:function(t,a,e){Vue.component("cart-table",e(193).default),Vue.component("cart-row",e(194).default);new Vue({el:"#cart",data:function(){return{products:[],carts:[],status:{totalcount:0,totalprice:0}}},methods:{getCart:function(){var t=this,a=$("#CartGetOneURL").text();axios.get(a).then((function(a){t.products=a.data.products;for(var e=0;e<t.products.length;e++)t.carts.push({index:t.carts.length,product:{id:t.products[e].id,coverImage:t.products[e].coverImage,name:t.products[e].name,retailPrice:t.products[e].retailPrice,showURL:t.products[e].showURL,maxQty:t.products[e].quantity<=999?t.products[e].quantity:999},quantity:t.products[e].pivot.quantity,subtotal:Math.round(t.products[e].pivot.subTotal)}),t.status.totalcount+=t.products[e].pivot.quantity,t.status.totalprice+=t.products[e].pivot.subTotal;t.status.totalprice=Math.round(t.status.totalprice),$.closeModal()})).catch((function(t){console.log("抓取購物車資料時錯誤。"),$.showErrorModal(t)}))}},created:function(){},mounted:function(){this.getCart()}})}});